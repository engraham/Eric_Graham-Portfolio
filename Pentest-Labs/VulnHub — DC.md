# Lab Report: VulnHub DC-1 ‚Äî Full Exploitation Chain

---
- Lab Type: Full-Stack Infrastructure Penetration Test  
- Skill Level: Intermediate  
- Focus: Enumeration, Web Exploitation, Privilege Escalation  
---
 - Author: Eric Graham
 - Date: 07/24/2025
 - Target: VulnHub DC-1

---

## üéØ Objective

Demonstrate a full exploitation chain on the DC-1 VulnHub VM.  
This lab shows how to gain a foothold, escalate privileges, access sensitive data, and document realistic mitigations.

---

## üõ†Ô∏è Lab Environment

- **Target:** DC-1 VulnHub VM
- **Attacker:** Kali Linux
- **Network:** NAT
- **Tools:** Nmap, Hydra, Metasploit, Netcat, Hashcat, John the Ripper

---

## üîó Exploitation Chain Summary

| Stage | Description |
|-------|--------------|
| Recon | Identified open services, Drupal CMS |
| Foothold | Exploited Drupalgeddon2 vulnerability |
| Privilege Escalation | Escalated from `www-data` to `root` |
| Post-Exploitation | Retrieved `thefinalflag.txt` |
| Mitigation | Patching, upgrade, and lockout controls |

---

## üîç Recon & Enumeration

**Nmap Full Port Scan**

```bash
nmap -sV -A <target-ip>
````
![nmap_scan](/screenshots/vulnhub/nmap_scan.png)

![netdiscovery](/screenshots/vulnhub/netdiscover.png)

![netdiscovery](/screenshots/vulnhub/netdiscovery_output.png)

**Result:**

* Port 80: Drupal site discovered
* Other open ports confirmed basic services

---

## ‚ö° Initial Foothold

**Vulnerability:** Drupalgeddon2 (CVE-2018-7600)

**Steps:**

1. Launched `exploit/unix/webapp/drupal_drupalgeddon2` in Metasploit:

   ```bash
   use exploit/unix/webapp/drupal_drupalgeddon2
   set RHOSTS <target-ip>
   set TARGETURI /  
   run
   ```
![metasploit](/screenshots/vulnhub/msf_search_exploit.png)

![metasploit](/screenshots/vulnhub/msf_drupalgeddon2.png)

2. Gained a `meterpreter` session.

3. Spawned a proper bash shell:

   ```bash
   python3 -c 'import pty; pty.spawn("/bin/bash")'
   ```
![meterpreter](/screenshots/vulnhub/script_better_shell.png)

---

## üöÄ Privilege Escalation

**Escalation Path:**

* Enumerated vulnerable configurations.
* Used `find` and `sudo` misconfigs to escalate from `www-data` to `root`.

**Proof:**

```bash
id
# uid=0(root)
```
![meterpreter](/screenshots/vulnhub/shell_root.png)


**Retrieved Final Flag:**

```bash
cd /root
ls
cat thefinalflag.txt
```

---

## üìå Post-Exploitation

* Verified root shell access.
* Enumerated system files.
* Extracted Drupal database creds.
* Identified password hash `$S$...` and cracked offline.

![drupal](/screenshots/vulnhub/drupal_user_escalation.png)

![meterpreter](/screenshots/vulnhub/user_table.png)

![meterpreter](/screenshots/vulnhub/eric_user_admin.png)


![meterpreter](/screenshots/vulnhub/hashcat_crack.png)

![meterpreter](/screenshots/vulnhub/hash_crack.png)
---

## ‚öñÔ∏è Risk & Business Impact

* **Risk:** Critical. Full system compromise including root access.
* **Impact:** Attackers could deface content, steal credentials, pivot to internal networks.
* **Likelihood:** High due to public exploit.

---

## üõ°Ô∏è Mitigation & Remediation

| Risk | Recommendation |
|------|----------------|
| Outdated Drupal core | Apply latest security patches |
| Weak admin password | Enforce strong, unique passwords |
| Brute-force possible | Limit login attempts & enable 2FA |
| Privilege escalation possible | Harden permissions & monitor logs |

---

## üìö Lessons Learned

* Using **Hydra** and **Hashcat** for brute force on **salted hashes** can be *very time-consuming* ‚Äî better to combine with other vectors (e.g., database access).
* Aggressive brute forcing on login forms with lockouts causes delays ‚Äî next time, check for lockout controls *before launching Hydra*.
* **Always note down** credentials, tables, and user hashes as you enumerate ‚Äî saves time if you need to reset or pivot later.
* Consider using `drupal user-password` SQL queries to reset admin passwords *directly* instead of brute forcing.
* **Document everything** ‚Äî clear evidence and commands help with report clarity.

---

## Final Outcome

**Root access confirmed, final flag captured.
Vulnerability chain: Recon ‚Üí Exploit ‚Üí Escalate ‚Üí Proof ‚Üí Mitigation.**

---

~ Eric Graham

